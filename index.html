<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">
    <title>Memory</title>
    <link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="style.css">

</head>
<body>


<div class="memory_board">
</div>

<div class="button_wrapper">
    <button class="memory-game_button">ðŸ”„</button>
</div>
</body>

<script>

    function flip(element) {
        element.classList.add('flip');
        element.classList.add('inactive');
    }

    function unflip(element) {
        element.classList.remove('flip');
        element.classList.remove('inactive');
    }

    function getTextFromCard(element) {
        return element.querySelector('.back').textContent;
    }

    function shuffle(arr) {
        let j, temp;
        for (let i = arr.length - 1; i > 0; i--) {
            j = Math.floor(Math.random() * (i + 1));
            temp = arr[j];
            arr[j] = arr[i];
            arr[i] = temp;
        }
        return arr;
    }

    function createBoard() {
        const memoryArray = [
            'ðŸ”ª', 'ðŸ”ª',
            'Steve', 'Steve',
            '65kÂ£', '65kÂ£',
            'CQRS', 'CQRS',
            'ðŸ“˜ing', 'ðŸ“˜ing',
            'ðŸ†ðŸ†', 'ðŸ†ðŸ†',
            'ðŸ¦€', 'ðŸ¦€',
            'O(ðŸ¤¦â€â™€ï¸)', 'O(ðŸ¤¦â€â™€ï¸)',
            'ðŸŸ¥', 'ðŸŸ¥',
            'âŒðŸ‘¨â€ðŸ’»', 'âŒðŸ‘¨â€ðŸ’»',
            'ðŸ', 'ðŸ',
            'ðŸ”„ðŸŒ³', 'ðŸ”„ðŸŒ³'];

        const newArray = shuffle(memoryArray);
        const memoryBoard = document.querySelector('.memory_board');
        newArray.forEach(function (elem) {
                let card = document.createElement('div');
                card.classList.add('memory_card');
                memoryBoard.appendChild(card);

                let backCard = document.createElement('div');
                backCard.classList.add('back');
                card.appendChild(backCard);
                backCard.textContent = elem;
                let fontCard = document.createElement('div');
                fontCard.classList.add('front');
                card.appendChild(fontCard);

                card.addEventListener('click', e => {
                    let currentCard = e.target.closest('.memory_card');
                    flip(currentCard);
                    let comparingCard = currentCard.parentElement.querySelector('.comparing');

                    if (comparingCard) {
                        let comparingCardText = getTextFromCard(comparingCard);
                        let currentCardText = getTextFromCard(currentCard);

                        if (comparingCardText === currentCardText) {
                            comparingCard.classList.remove('comparing');
                            comparingCard.classList.add('success');
                            currentCard.classList.add('success');
                        } else {
                            memoryBoard.classList.add('inactive');

                            setTimeout(() => {
                                memoryBoard.classList.remove('inactive');
                                comparingCard.classList.remove('comparing');
                                comparingCard.classList.add('failed');
                                currentCard.classList.add('failed');
                                unflip(comparingCard);
                                unflip(currentCard);
                                setTimeout(() => {
                                    comparingCard.classList.remove('failed');
                                    currentCard.classList.remove('failed');
                                }, 1000)
                            }, 1000);
                        }
                    } else {
                        currentCard.classList.add('comparing');
                    }
                })
            }
        )
    }

    let button = document.querySelector(".memory-game_button");
    let memoryBoard = document.querySelector('.memory_board');
    button.addEventListener('click', e => {
        memoryBoard.innerHTML = '';
        createBoard();
    });
    createBoard();


</script>
</html>
